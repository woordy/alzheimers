<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <title>Alzheimer’s Disease and Cognitive Impairment Prediction</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link rel="stylesheet" href="css/normalize.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/cayman.css">
</head>

<body>
    <section class="page-header">
        <h1 class="project-name">Alzheimer’s Disease and Cognitive Impairment Prediction</h1>
        <h2 class="project-tagline">Eliud Omollo</h2>
        <a href="#ExploratoryDataAnalysis" class="btn">Exploratory Data Analysis</a>
        <a href="#Predictions" class="btn">Predictions</a>
        <a href="https://github.com/woordy/woordy.github.io" class="btn">GitHub Raw Code</a>
        <a href="#Summary" class="btn">Summary</a>
    </section>

    <section class="main-content">
        <h2><a id="user-content-header-2" class="anchor" href="#header-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>I. Problem Statement and Motivation</h2>

        <p>In this study, we examine the significance of a subject's medical history in predicting symptoms of dementia or Alzheimer's disease.</p>
        <h2><a id="user-content-header-2" class="anchor" href="#header-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>II. Introduction</h2>
        <p>Alzheimer’s is a disease that erodes a patient’s memory, thinking skills and leads to poor judgement, reasoning, planning, language, and inability to perform simple tasks. It is the most common type of dementia affecting more than 5 million Americans. It is ranked as the 6th leading cause of death in the United States</p>
        <p>Unfortunately, there is currently no cure for the disease. To find the cure for the disease, the first step is to learn and understand the cause of the disease.</p>

        <h3><a id="user-content-header-3" class="anchor" href="#header-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>A. Risk Factors</h3>

        <ol class="task-list">
            <li>
                <strong>Age: </strong>Studies show that the risk of developing Alzheimer’s increases with age.
            </li>
            <li><strong>Genetics: </strong>The presence of certain genes, e.g.<a href="https://en.wikipedia.org/wiki/Apolipoprotein_E">apolipoprotein e4 (APoE4)</a> increase the risk of developing Alzheimer’s.
            </li>
            <li><strong>Sex: </strong>Studies show that women are at a higher risk for developing Alzheimer’s compared to men.
            </li>
            <li><strong>Past Medical History: </strong>Subjects with Obesity, High blood pressure etc. have a higher chance of developing Alzheimer’s
            </li>
        </ol>

        <h3><a id="user-content-header-3" class="anchor" href="#header-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>B. Description of Data:</h3>
        <p>The data for this study was obtained from <a href="http://www.adni-info.org/">ADNI (Alzheimer’s Disease Neuroimaging Initiative).</a> The data is maintained at USC’s Laboratory of Neuroimaging at <a href="http://adni.loni.usc.edu/"> ADNI LONI</a></p>
        <p>The data is grouped into the following categories:</p>

        <ol class="task-list">
            <li>Assessments</li>
            <li>Biospecimen</li>
            <li>Enrollment</li>
            <li>Genetic</li>
            <li>Imaging </li>
            <li>Study Info</li>
            <li>Subject Characteristics</li>
            <li>Test Data</li>
            <li>_Archive </li>
            <li>_ALL </li>
        </ol>

        <p>For this study, we specifically used the following datasets:</p>
        <ul class="task-list">
            <li>Medical History <span>&#8594;</span> Medical History<span>&#8594;</span> Medical History [ADNI1,GO,2]</li>
            <li>Merged Data: Study Info <span>&#8594;</span> Data & Databases <span>&#8594;</span> Key ADNI tables merged into one table</li>
        </ul>
        <h3><a id="user-content-header-3" class="anchor" href="#header-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>C. Target Variable</h3>
        <p>The data target variable for this study is the "DX" column found the on ADNIMERGE.csv dataset</p>
        <table>
            <thead>
                <tr>
                    <th>Target</th>
                    <th>Abbreviation</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Normal Aging /Cognitively Normal</td>
                    <td>CN</td>
                    <td>CN participants are the control subjects in the ADNI study. They show no signs of depression, mild cognitive impairment or dementia</td>
                </tr>
                <tr>
                    <td>Significant Memory Concern</td>
                    <td>MCI</td>
                    <td>MC participants score within normal range for cognition (or CDR = 0) but indicate that they have a concern, and exhibit slight forgetfulness. The informant does not equate this as progressive memory impairment nor considers this as consistent forgetfulness.</td>
                </tr>
                <tr>
                    <td>Dementia</td>
                    <td>Dementia</td>
                    <td>Dementia</td>
                </tr>
            </tbody>
        </table>



        <h2><a id="user-content-header-2" class="anchor" href="#header-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>III: Preprocessing</h2>
        <p><strong>1: Merge: </strong>Merged the data using RID Column to guarantee that the medical record information on MEDHIST.csv correctly mapped to the data on ADNIMERGE.csv file.</p>
        <p><strong>2. Evaluate Missing Data: </strong>Investigated missing data and observed that the following columns had null values:</p>
        <p><img src="img/missing-data.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></p>

        <p>These columns represent alcohol consumption, drug abuse and smoking. We considered using data imputation techniques to impute the missing data. But we ultimately decided against it. In our view, it’s would be inaccurate to use other feautures on the dataset to impute the values of smoker/drug user/alcohol consumption without a deep understanding of causal inference. We ultimately decided to drop these columns from the model. We also decided to drop the rows that did not have DX for the same reasons.</p>
        <p><strong>3. Encode Output: </strong>The target variable is presented in the form of labels i.e. ‘CN’,’MCI’, ‘Dementia’. We used the LabelEncoder() method to encode the target as follows:</p>
        <pre><code>#encode the labels
<br>from sklearn import preprocessing
<br>le = preprocessing.LabelEncoder()
<br>data['DX_'] = le.fit_transform(data['DX'])
<br>print(le.inverse_transform([0, 1, 2]))
<br>data = data.drop('DX', axis=1)</code>
</pre>
        <table>
            <thead>
                <tr>
                    <th>Target</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>CN</td>
                    <td>0</td>
                </tr>
                <tr>
                    <td>Dementia</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>MCI</td>
                    <td>2</td>
                </tr>
            </tbody>
        </table>

        <h2><a id="user-content-header-2" class="anchor" href="#header-2" aria-hidden="true"><span class="octicon octicon-link"></span></a><a name="ExploratoryDataAnalysis"></a>IV. Exploratory Data Analysis</h2>
        <p><img src="img/dx-pie.png" alt="dx-pie" data-canonical-src="" style="max-width:100%;"></p>
        Observe that the DX data is unbalanced and so we expect the model to be biased towards one class. Closer attention will need to be made on the confusion matrix
        <p>The charts below the histogram of DX colored by each feature type</p>
        <table>
            <tbody>
                <tr>
                    <td><img src="img/ft-01.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-02.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-03.png" alt="dx count" data-canonical-src="" style="max-width:100%;"> </td>
                    <td><img src="img/ft-04.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-05.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                </tr>
                <tr>
                    <td><img src="img/ft-06.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-07.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td> <img src="img/ft-08.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-09.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-10.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                </tr>
                <tr>
                    <td><img src="img/ft-11.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-12.png" alt="dx count" data-canonical-src="" style="max-width:100%;"> </td>
                    <td><img src="img/ft-13.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-14.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-15.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                </tr>
                <tr>
                    <td><img src="img/ft-16.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-17.png" alt="dx count" data-canonical-src="" style="max-width:100%;"> </td>
                    <td><img src="img/ft-18.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-19.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                    <td><img src="img/ft-20.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></td>
                </tr>
            </tbody>
        </table>

        <p>We examine the corelation between the variables and observed </p>
        <p>Pair plot of features</p>
        <p><img src="img/pairplots.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></p>
        <p>Histogram of Features</p>
        <p><img src="img/ft-hist.png" alt="dx count" data-canonical-src="" style="max-width:100%;"></p>

        <h2><a id="user-content-header-2" class="anchor" href="#header-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model Selection</h2>
        <p>We will use LogisticRegression with cross validation as a base model for our system. The table below shows the Classfication Report report for this model. Given the unbalanced nature of the data, the f1-score will be a better metric of measurements.F1-score is a weighted average of the precision and recall, with the best values at 1 and worst score at 0.</p>
        <table>
            <thead>
                <tr>
                    <th>Class</th>
                    <th>precision</th>
                    <th>recall</th>
                    <th>f1-score </th>
                    <th>support</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>0</td>
                    <td>0.41</td>
                    <td>0.23 </td>
                    <td>0.30 </td>
                    <td>1155</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td> 0.75</td>
                    <td> 0.00</td>
                    <td>0.01</td>
                    <td>734</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>0.47 </td>
                    <td>0.82</td>
                    <td>0.60</td>
                    <td>1654</td>
                </tr>
                <tr>
                    <td>avg / total</td>
                    <td> 0.51 </td>
                    <td>0.46</td>
                    <td>0.38</td>
                    <td>3543</td>
                </tr>

            </tbody>
        </table>
        <p>As expected the base model does relatively well in predicting class 2 because of the imbalance.</p>

        <h2><a id="user-content-header-2" class="anchor" href="#header-2" aria-hidden="true"><span class="octicon octicon-link"></span></a><a name="Predictions"></a>Predictions</h2>
        <p>We evaluated the following models</p>
        <ol class="task-list">

            <li>Linear DiscriminantAnalysis: LDA presented very low results and predictive ability </li>
            <li>Quadratic Discriminant Analysis: Perfomed better that LDA with increase f1-score on classs 1</li>
            <li>K Neighbors Classifier: We observed that as K increased aove K=5, both the accuracy and F1-Score began to decrease</li>
            <li>Random Forest Classifier: Results are shown below</li>
        </ol>
        <p>We did this by creating a pipeline of the models, then performed parameter tuning using crosss-validation, boostrap and Grid-Search. For this data, Random Forrest classifer produced the best results. </p>
        Train Score: 0.826856121201 | Test Score: 0.76883996613
        <p>Because of the classs imbalance, we examine the classication report for additional information</p>
        <p> The Classification table below shows the following results</p>

        <table>
            <thead>
                <tr>
                    <th>Class</th>
                    <th>precision</th>
                    <th>recall</th>
                    <th>f1-score </th>
                    <th>support</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>0</td>
                    <td>0.82</td>
                    <td>0.85 </td>
                    <td>0.83 </td>
                    <td>1155</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td> 0.67</td>
                    <td> 0.57</td>
                    <td>0.61</td>
                    <td>734</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>0.77 </td>
                    <td>0.80</td>
                    <td>0.79</td>
                    <td>1654</td>
                </tr>
                <tr>
                    <td>avg / total</td>
                    <td> 0.77 </td>
                    <td>0.77</td>
                    <td>0.77</td>
                    <td>3543</td>
                </tr>

            </tbody>
        </table>
        <p>For all three classes, the F1-score has significantly improved over the Logistical regression base model.</p>
        <h2><a id="user-content-header-2" class="anchor" href="#header-2" aria-hidden="true"><span class="octicon octicon-link"></span></a><a name="Summary"></a>Summary</h2>
        <p>In this exercise, we have that showed subjects with certain health risks, have a greater like hood of developing Alzheimer's. However, it's not sufficient to conclude that given a patient who presents a medical history identical to those examined on this study, that this model will accurately predict whether that patient has Alzheimer’. Perhaps other causal features exist that haven't been studied</p>


        <h3><a id="user-content-header-3" class="anchor" href="#header-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Factors that warrant additional study</h3>

        <ol class="task-list">
            <li>
                <strong>Longitudinal Data:  </strong>The data that we used was collected at different time points. A more in-depth analysis of longitudinal effects is therefore necessary.
            </li>
            <li><strong>Patient Participation:  </strong>At different timepoints, some patients either did not participate or when they did, incomplete data was collected. This situation leads to significance being given to patient who participate and whose data are complete. The sample data is therefore not a true representative of the entire population.
            </li>
            <li><strong>Race:  </strong>The participants in the study overwhelmingly identify as white and therefore do not necessarily represent a true sample of the Alzheimer’s population. Perhaps the assessments, genetics and medical history would yield different results for a different ethnicity. Further, this study is limited to Americans and perhaps a more causality inference study should be examined. Lastly, no objective criterial is provided to identify a person as belonging to one or another.
            </li>
        </ol>
        <h2><a id="user-content-header-2" class="anchor" href="#header-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Credits and References</h2>
        <ol class="task-list">
            <li>
                <strong><a href="https://www.nia.nih.gov/health/alzheimers">About Alzheimers: </a></strong>https://www.nia.nih.gov/health/alzheimers
            </li>
            <li><strong><a href="http://adni.loni.usc.edu/study-design/background-rationale/">Target Variable Description:</a>  </strong>http://adni.loni.usc.edu/study-design/background-rationale/
            </li>
            <li><strong><a href="https://hsc.unm.edu/research/ctsc/Docs/longitudinal.pdf">Longitudinal Data:</a> </strong>https://hsc.unm.edu/research/ctsc/Docs/longitudinal.pdf
            </li>
        </ol>


        <footer class="site-footer">
            <span class="site-footer-owner"></span>
            <span class="site-footer-credits"></span>
        </footer>

    </section>

</body>

</html>
